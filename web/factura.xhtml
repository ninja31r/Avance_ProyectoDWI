<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>Factura Generada | Auditel Import S.A.C</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
</h:head>

<h:body class="bg-light">

    <!-- Encabezado -->
    <ui:include src="/components/layout/header.xhtml"/>

    <div class="container mt-5 mb-5">
        <div class="card shadow-lg rounded-4">

            <!-- ENCABEZADO DE FACTURA -->
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <span><i class="bi bi-receipt"></i> Factura de Venta</span>
                <span>#{facturaBean.numeroFactura}</span>
            </div>

            <!-- CUERPO PRINCIPAL -->
            <div class="card-body">
                <h:panelGrid columns="2" cellpadding="5" style="width:100%">
                    <h:outputText value="Cliente:" styleClass="fw-semibold"/>
                    <h:outputText value="#{facturaBean.clienteNombre}" />

                    <h:outputText value="TelÃ©fono:" styleClass="fw-semibold"/>
                    <h:outputText value="#{facturaBean.clienteTelefono}" />

                    <h:outputText value="Fecha:" styleClass="fw-semibold"/>
                    <h:outputText value="#{facturaBean.fechaGenerada}">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
                    </h:outputText>
                </h:panelGrid>

                <hr/>

                <!-- TABLA DE PRODUCTOS -->
                <h:dataTable value="#{facturaBean.productos}" var="p"
                             styleClass="table table-striped text-center align-middle mt-3">
                    <h:column>
                        <f:facet name="header">Producto</f:facet>
                        #{p.nombre}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Cantidad</f:facet>
                        #{p.stock}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Precio</f:facet>
                        S/ #{p.precio}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Subtotal</f:facet>
                        S/ #{p.precio * p.stock}
                    </h:column>
                </h:dataTable>

                <!-- TOTALES -->
                <div class="text-end fw-bold mt-3">
                    <p>Subtotal: S/ #{facturaBean.subtotalFormateado}</p>
                    <p>IGV (18%): S/ #{facturaBean.igvFormateado}</p>
                    <p>Total a pagar: S/ #{facturaBean.totalFormateado}</p>
                </div>
            </div> 

            <!-- PIE DE FACTURA -->
            <div class="card-footer bg-light text-end">
                <h:form>
                    <h:outputLink value="ProductoServlet" styleClass="btn btn-outline-primary me-2">
                        <i class="bi bi-arrow-left-circle"></i> Seguir comprando
                    </h:outputLink>

                    <h:commandLink value="Vaciar carrito"
                                   action="#{carritoBean.vaciarCarrito}"
                                   styleClass="btn btn-danger ms-2"/>
                </h:form>
            </div> 

        </div> 
    </div> 

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</h:body>
</html>
